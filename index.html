<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‰‹æœ¯å®¤ç›¯å°ç­¾åˆ°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #1e3c72 100%);
            min-height: 100vh;
            padding: 16px;
            padding-bottom: 100px;
        }
        
        .container {
            max-width: 420px;
            margin: 0 auto;
        }
        
        /* å¤´éƒ¨å¡ç‰‡ */
        .header-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 20px;
            padding: 28px 24px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .header-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(30,60,114,0.05) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo-icon {
            font-size: 48px;
            display: block;
            margin-bottom: 8px;
        }
        
        .logo h1 {
            font-size: 22px;
            color: #1e3c72;
            font-weight: 700;
        }
        
        .logo .subtitle {
            font-size: 13px;
            color: #888;
            margin-top: 4px;
        }
        
        .date-display {
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 14px;
            color: white;
            margin-bottom: 20px;
        }
        
        .date-display .date {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .date-display .weekday {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 4px;
        }
        
        .status-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .status-tag.surgery {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            animation: pulse 2s infinite;
        }
        
        .status-tag.rest {
            background: #f5f5f5;
            color: #999;
        }
        .status-tag.occasional {
    background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
    color: white;
}
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(76,175,80,0.4); }
            50% { box-shadow: 0 0 0 10px rgba(76,175,80,0); }
        }
        
        /* ç­¾åˆ°è¡¨å• */
        .form-section {
            margin-top: 24px;
        }
        
        .form-label {
            font-size: 15px;
            color: #333;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .staff-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .staff-btn {
            padding: 14px 8px;
            border: 2px solid #e8ecf4;
            border-radius: 12px;
            background: white;
            font-size: 14px;
            font-weight: 500;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .staff-btn:active {
            transform: scale(0.96);
        }
        
        .staff-btn.selected {
            border-color: #1e3c72;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(30,60,114,0.3);
        }
        
        .submit-btn {
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border: none;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 6px 25px rgba(76,175,80,0.35);
        }
        
        .submit-btn:active {
            transform: scale(0.98);
        }
        
        .submit-btn:disabled {
            background: #ccc;
            box-shadow: none;
            cursor: not-allowed;
        }
        
        .performance-hint {
            text-align: center;
            margin-top: 16px;
            padding: 12px;
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            border-radius: 10px;
            font-size: 13px;
            color: #856404;
        }
        
        .performance-hint strong {
            color: #d4850a;
            font-size: 16px;
        }
        
        /* æˆåŠŸçŠ¶æ€ */
        .success-section {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 40px;
            color: white;
            animation: successPop 0.5s ease;
        }
        
        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .success-section h2 {
            color: #2e7d32;
            font-size: 22px;
            margin-bottom: 8px;
        }
        
        .success-section .detail {
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .checkin-again-btn {
            padding: 12px 32px;
            background: white;
            border: 2px solid #1e3c72;
            border-radius: 10px;
            color: #1e3c72;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        
        /* è®°å½•å¡ç‰‡ */
        .records-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            margin-bottom: 16px;
        }
        
        .records-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .records-header h3 {
            font-size: 16px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .records-count {
            background: #1e3c72;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            background: #f8f9ff;
            border-radius: 12px;
            margin-bottom: 8px;
        }
        
        .record-item:last-child {
            margin-bottom: 0;
        }
        
        .record-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .record-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
        }
        
        .record-name {
            font-weight: 600;
            color: #333;
            font-size: 15px;
        }
        
        .record-time {
            font-size: 13px;
            color: #888;
        }
        
        .empty-state {
            text-align: center;
            padding: 30px;
            color: #999;
        }
        
        .empty-state .icon {
            font-size: 48px;
            margin-bottom: 12px;
            opacity: 0.5;
        }
        
        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .stats-header h3 {
            font-size: 16px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .month-selector {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 13px;
            color: #333;
            background: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            background: linear-gradient(135deg, #f8f9ff 0%, #eef1fb 100%);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #1e3c72;
        }
        
        .stat-label {
            font-size: 12px;
            color: #888;
            margin-top: 4px;
        }
        
        .ranking-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .ranking-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .ranking-item:last-child {
            border-bottom: none;
        }
        
        .rank-num {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            margin-right: 12px;
            background: #f0f0f0;
            color: #666;
        }
        
        .rank-num.top1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffb700 100%);
            color: white;
        }
        
        .rank-num.top2 {
            background: linear-gradient(135deg, #c0c0c0 0%, #a8a8a8 100%);
            color: white;
        }
        
        .rank-num.top3 {
            background: linear-gradient(135deg, #cd7f32 0%, #b87333 100%);
            color: white;
        }
        
        .rank-info {
            flex: 1;
        }
        
        .rank-name {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .rank-stats {
            text-align: right;
        }
        
        .rank-count {
            font-weight: 700;
            color: #1e3c72;
            font-size: 16px;
        }
        
        .rank-performance {
            font-size: 11px;
            color: #4CAF50;
        }
        
        /* åº•éƒ¨å¯¼èˆªæç¤º */
        .doc-link-card {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            border-radius: 14px;
            padding: 16px;
            margin-top: 16px;
            text-align: center;
        }
        
        .doc-link-card p {
            font-size: 13px;
            color: #856404;
            margin-bottom: 10px;
        }
        
        .doc-link-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            background: #1e3c72;
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-size: 13px;
            font-weight: 600;
        }
        
        /* å¯¼å‡ºæŒ‰é’® */
        .export-btn {
            width: 100%;
            padding: 12px;
            margin-top: 16px;
            background: white;
            border: 2px solid #1e3c72;
            border-radius: 10px;
            color: #1e3c72;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨å¡ç‰‡ -->
        <div class="header-card">
            <div class="logo">
                <span class="logo-icon">ğŸ¥</span>
                <h1>æ‰‹æœ¯å®¤ç›¯å°ç­¾åˆ°</h1>
                <div class="subtitle">æ¯å‘¨äºŒã€å‘¨äº” | ç›¯å°ç»©æ•ˆ 1.3 ä»½/æ¬¡</div>
            </div>
            
            <div class="date-display">
                <div class="date" id="currentDate"></div>
                <div class="weekday" id="weekdayText"></div>
                <span class="status-tag" id="statusTag"></span>
            </div>
            
            <!-- ç­¾åˆ°è¡¨å• -->
            <div class="form-section" id="formSection">
                <div class="form-label">ğŸ‘¤ è¯·é€‰æ‹©æ‚¨çš„å§“å</div>
                <div class="staff-grid" id="staffGrid"></div>
                <button class="submit-btn" id="submitBtn" onclick="submitCheckin()">
                    <span>âœ“</span> ç¡®è®¤ç­¾åˆ°
                </button>
                <div class="performance-hint">
                    ğŸ’° æ¯æ¬¡ç›¯å°ç­¾åˆ°å¯è·å¾— <strong>1.3 ä»½</strong> ç»©æ•ˆå¥–åŠ±
                </div>
            </div>
            
            <!-- ç­¾åˆ°æˆåŠŸ -->
            <div class="success-section" id="successSection">
                <div class="success-icon">âœ“</div>
                <h2>ç­¾åˆ°æˆåŠŸï¼</h2>
                <p class="detail" id="successDetail"></p>
                <button class="checkin-again-btn" onclick="resetForm()">è¿”å›</button>
            </div>
        </div>
        
        <!-- ä»Šæ—¥ç­¾åˆ°è®°å½• -->
        <div class="records-card">
            <div class="records-header">
                <h3>ğŸ“‹ ä»Šæ—¥ç­¾åˆ°</h3>
                <span class="records-count" id="recordsCount">0 äºº</span>
            </div>
            <div id="recordsList">
                <div class="empty-state">
                    <div class="icon">ğŸ“</div>
                    <div>æš‚æ— ç­¾åˆ°è®°å½•</div>
                </div>
            </div>
        </div>
        
        <!-- æœ¬æœˆç»Ÿè®¡ -->
        <div class="stats-card">
            <div class="stats-header">
                <h3>ğŸ“Š æœˆåº¦ç»Ÿè®¡</h3>
                <select class="month-selector" id="monthSelector" onchange="updateStats()"></select>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalCheckins">0</div>
                    <div class="stat-label">æ€»ç­¾åˆ°æ¬¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalPerformance">0</div>
                    <div class="stat-label">æ€»ç»©æ•ˆä»½æ•°</div>
                </div>
            </div>
            
            <div class="form-label">ğŸ† æ’è¡Œæ¦œ</div>
            <div class="ranking-list" id="rankingList"></div>
            
            <button class="export-btn" onclick="exportData()">
                <span>ğŸ“¤</span> å¯¼å‡ºæœ¬æœˆæ•°æ®
            </button>
        </div>
        
        <!-- è…¾è®¯æ–‡æ¡£é“¾æ¥æç¤º -->
        <div class="doc-link-card" id="docLinkCard" style="display:none;">
            <p>ğŸ“Œ ç­¾åˆ°æ•°æ®å·²åŒæ­¥ä¿å­˜ï¼Œç‚¹å‡»æŸ¥çœ‹å®Œæ•´è®°å½•</p>
            <a href="#" class="doc-link-btn" id="docLink" target="_blank">
                <span>ğŸ“Š</span> æŸ¥çœ‹è…¾è®¯æ–‡æ¡£
            </a>
        </div>
    </div>

    <script>
        // ========== é…ç½®åŒºåŸŸ ==========
        const STAFF_LIST = [
            'éŸ©æ³¢', 'å¼ å»ºå†›', 'ä¼Šè¿æ˜¥', 'å§œæ®¿ä¸œ', 'ç‹é™', 'ç‹è‰³',
            'èŒƒå³é£', 'å•å»ºåˆ©', 'è´¾æµ·ç³', 'çŸ³ç³', 'æ¨æ™“æ–', 'æˆ¿æ…§å¨Ÿ'
        ];
        
        // ç»©æ•ˆç³»æ•°
        const PERFORMANCE_RATE = 1.3;
        
        // å›ºå®šæ‰‹æœ¯æ—¥ï¼š2 = å‘¨äºŒï¼Œ5 = å‘¨äº”
const SURGERY_DAYS = [2, 5];

// å¶å°”æ‰‹æœ¯æ—¥ï¼š4 = å‘¨å››ï¼Œ6 = å‘¨å…­
const OCCASIONAL_SURGERY_DAYS = [4, 6];
        
        // è…¾è®¯æ–‡æ¡£æ”¶é›†è¡¨é“¾æ¥ï¼ˆåˆ›å»ºåå¡«å…¥ï¼‰
        const TENCENT_DOC_URL = '';
        // ========== é…ç½®ç»“æŸ ==========
        
        const STORAGE_KEY = 'surgery_checkin_data_v2';
        let selectedStaff = null;
        
        // åˆå§‹åŒ–
        function init() {
            updateDateDisplay();
            renderStaffButtons();
            initMonthSelector();
            loadTodayRecords();
            updateStats();
            
            if (TENCENT_DOC_URL) {
                document.getElementById('docLinkCard').style.display = 'block';
                document.getElementById('docLink').href = TENCENT_DOC_URL;
            }
        }
        
        // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
function updateDateDisplay() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth() + 1;
    const day = now.getDate();
    const weekday = now.getDay();
    
    const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
    
    document.getElementById('currentDate').textContent = 
        `${year}å¹´${month}æœˆ${day}æ—¥`;
    document.getElementById('weekdayText').textContent = 
        `æ˜ŸæœŸ${weekdays[weekday]}`;
    
    const tag = document.getElementById('statusTag');
    if (SURGERY_DAYS.includes(weekday)) {
        tag.innerHTML = 'ğŸ”´ ä»Šå¤©æ˜¯æ‰‹æœ¯æ—¥';
        tag.className = 'status-tag surgery';
    } else if (OCCASIONAL_SURGERY_DAYS.includes(weekday)) {
        tag.innerHTML = 'ğŸŸ¡ ä»Šå¤©å¶å°”æœ‰æ‰‹æœ¯';
        tag.className = 'status-tag occasional';
    } else {
        tag.innerHTML = 'âšª ä»Šå¤©ä¸æ˜¯æ‰‹æœ¯æ—¥';
        tag.className = 'status-tag rest';
    }
}
        
        // æ¸²æŸ“äººå‘˜æŒ‰é’®
        function renderStaffButtons() {
            const grid = document.getElementById('staffGrid');
            grid.innerHTML = STAFF_LIST.map(name => 
                `<button class="staff-btn" onclick="selectStaff('${name}', this)">${name}</button>`
            ).join('');
        }
        
        // é€‰æ‹©äººå‘˜
        function selectStaff(name, btn) {
            document.querySelectorAll('.staff-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedStaff = name;
        }
        
        // è·å–å­˜å‚¨æ•°æ®
        function getData() {
            return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"records":{}}');
        }
        
        // ä¿å­˜æ•°æ®
        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }
        
        // è·å–æ—¥æœŸå­—ç¬¦ä¸²
        function getDateStr(date = new Date()) {
            return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
        }
        
        // è·å–æ—¶é—´å­—ç¬¦ä¸²
        function getTimeStr() {
            const now = new Date();
            return `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
        }
        
        // æäº¤ç­¾åˆ°
        function submitCheckin() {
            if (!selectedStaff) {
                alert('è¯·é€‰æ‹©æ‚¨çš„å§“å');
                return;
            }
            
            const dateStr = getDateStr();
            const time = getTimeStr();
            const data = getData();
            
            if (!data.records[dateStr]) {
                data.records[dateStr] = [];
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²ç­¾åˆ°
            if (data.records[dateStr].some(r => r.name === selectedStaff)) {
                alert(`${selectedStaff} ä»Šå¤©å·²ç»ç­¾åˆ°è¿‡äº†`);
                return;
            }
            
            // æ·»åŠ è®°å½•
            data.records[dateStr].push({
                name: selectedStaff,
                time: time,
                timestamp: Date.now()
            });
            
            saveData(data);
            
            // æ˜¾ç¤ºæˆåŠŸ
            document.getElementById('formSection').style.display = 'none';
            document.getElementById('successSection').style.display = 'block';
            document.getElementById('successDetail').textContent = 
                `${selectedStaff}ï¼Œ${dateStr} ${time}\næœ¬æ¬¡è·å¾— ${PERFORMANCE_RATE} ä»½ç»©æ•ˆ`;
            
            // åˆ·æ–°æ˜¾ç¤º
            loadTodayRecords();
            updateStats();
        }
        
        // é‡ç½®è¡¨å•
        function resetForm() {
            document.getElementById('formSection').style.display = 'block';
            document.getElementById('successSection').style.display = 'none';
            document.querySelectorAll('.staff-btn').forEach(b => b.classList.remove('selected'));
            selectedStaff = null;
        }
        
        // åŠ è½½ä»Šæ—¥è®°å½•
        function loadTodayRecords() {
            const data = getData();
            const dateStr = getDateStr();
            const records = data.records[dateStr] || [];
            
            document.getElementById('recordsCount').textContent = `${records.length} äºº`;
            
            const container = document.getElementById('recordsList');
            
            if (records.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ“</div>
                        <div>æš‚æ— ç­¾åˆ°è®°å½•</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = records.map(r => `
                <div class="record-item">
                    <div class="record-info">
                        <div class="record-avatar">${r.name[0]}</div>
                        <span class="record-name">${r.name}</span>
                    </div>
                    <span class="record-time">${r.time}</span>
                </div>
            `).join('');
        }
        
        // åˆå§‹åŒ–æœˆä»½é€‰æ‹©å™¨
        function initMonthSelector() {
            const selector = document.getElementById('monthSelector');
            const now = new Date();
            const options = [];
            
            for (let i = 0; i < 6; i++) {
                const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const value = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
                const label = `${d.getFullYear()}å¹´${d.getMonth()+1}æœˆ`;
                options.push(`<option value="${value}">${label}</option>`);
            }
            
            selector.innerHTML = options.join('');
        }
        
        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            const selectedMonth = document.getElementById('monthSelector').value;
            const data = getData();
            
            // ç»Ÿè®¡æœ¬æœˆæ•°æ®
            const monthStats = {};
            let totalCount = 0;
            
            Object.entries(data.records).forEach(([dateStr, records]) => {
                if (dateStr.startsWith(selectedMonth)) {
                    records.forEach(r => {
                        if (!monthStats[r.name]) {
                            monthStats[r.name] = 0;
                        }
                        monthStats[r.name]++;
                        totalCount++;
                    });
                }
            });
            
            // æ›´æ–°æ€»è®¡
            document.getElementById('totalCheckins').textContent = totalCount;
            document.getElementById('totalPerformance').textContent = 
                (totalCount * PERFORMANCE_RATE).toFixed(1);
            
            // æ’è¡Œæ¦œ
            const ranking = Object.entries(monthStats)
                .sort((a, b) => b[1] - a[1]);
            
            const rankingContainer = document.getElementById('rankingList');
            
            if (ranking.length === 0) {
                rankingContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ“Š</div>
                        <div>æœ¬æœˆæš‚æ— æ•°æ®</div>
                    </div>
                `;
                return;
            }
            
            rankingContainer.innerHTML = ranking.map((item, index) => {
                const [name, count] = item;
                let rankClass = '';
                if (index === 0) rankClass = 'top1';
                else if (index === 1) rankClass = 'top2';
                else if (index === 2) rankClass = 'top3';
                
                return `
                    <div class="ranking-item">
                        <div class="rank-num ${rankClass}">${index + 1}</div>
                        <div class="rank-info">
                            <div class="rank-name">${name}</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-count">${count} æ¬¡</div>
                            <div class="rank-performance">+${(count * PERFORMANCE_RATE).toFixed(1)} ä»½</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const selectedMonth = document.getElementById('monthSelector').value;
            const data = getData();
            
            let csv = 'æ—¥æœŸ,å§“å,ç­¾åˆ°æ—¶é—´,ç»©æ•ˆä»½æ•°\n';
            
            Object.entries(data.records)
                .filter(([dateStr]) => dateStr.startsWith(selectedMonth))
                .sort((a, b) => a[0].localeCompare(b[0]))
                .forEach(([dateStr, records]) => {
                    records.forEach(r => {
                        csv += `${dateStr},${r.name},${r.time},${PERFORMANCE_RATE}\n`;
                    });
                });
            
            // åˆ›å»ºä¸‹è½½
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ç›¯å°ç­¾åˆ°è®°å½•_${selectedMonth}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // å¯åŠ¨
        init();
    </script>
</body>

</html>
